/*
** main.c for PSU_2014_philo in /home/denel-_l/rendu/PSU_2014_philo
**
** Made by denel-_l
** Login   <denel-_l@epitech.net>
**
** Started on  Fri Feb 27 14:49:50 2015 denel-_l
** Last update Fri Feb 27 15:06:11 2015 denel-_l
*/

#include "Action.h"

int		main(void)
{
  t_philo	*philo;
  t_philo	*tmp;
  int		i;

  i = 1;
  philo = init();
  while (i < 7)
    {
      pushafter(philo, i + 1);
      i++;
    }
  tmp = philo->next;
  if (pthread_create(&philo->my_thread, NULL, doSomeThing, (void*)philo) != 0)
    return (0);
  if (pthread_mutex_init(&philo->my_mutex, NULL) != 0)
    return (0);
  while (tmp != philo && reserve > 0)
    {
      if (pthread_create(&tmp->my_thread, NULL, doSomeThing, (void*)tmp) != 0)
	return (0);
      if (pthread_mutex_init(&tmp->my_mutex, NULL) != 0)
	return (0);
      tmp = tmp->next;
    }
  tmp = philo->next;
  pthread_join(philo->my_thread, NULL);
  while (tmp != philo)
    {
      pthread_join(tmp->my_thread, NULL);
      tmp = tmp->next;
    }
  return (0);
}
